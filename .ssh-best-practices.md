# SSH è®¤è¯æœ€ä½³å®è·µé…ç½®æŒ‡å—

## ğŸ¯ å½“å‰é…ç½®

### å·²é…ç½®çš„åŠŸèƒ½ï¼š
- âœ… SSH å¯†é’¥å¸¦å¯†ç ä¿æŠ¤
- âœ… è‡ªåŠ¨åŠ è½½åˆ° ssh-agent
- âœ… ä¿å­˜åˆ° macOS Keychainï¼ˆé‡å¯åè‡ªåŠ¨è§£é”ï¼‰
- âœ… AddKeysToAgent è‡ªåŠ¨ç®¡ç†
- âœ… è¿æ¥ä¼˜åŒ–é…ç½®

### æ–‡ä»¶åˆ—è¡¨ï¼š
```
~/.ssh/github_key          # ç§é’¥ (600æƒé™)
~/.ssh/github_key.pub      # å…¬é’¥ (644æƒé™)
~/.ssh/config              # SSHé…ç½®æ–‡ä»¶ (600æƒé™)
```

## ğŸ”§ æ—¥å¸¸ä½¿ç”¨

### é¦–æ¬¡ä½¿ç”¨ï¼ˆæ–°ç»ˆç«¯ï¼‰ï¼š
```bash
# å¯åŠ¨ ssh-agent å¹¶æ·»åŠ å¯†é’¥ï¼ˆè¾“å…¥ä¸€æ¬¡å¯†ç ï¼‰
eval "$(ssh-agent -s)"
ssh-add --apple-use-keychain ~/.ssh/github_key
```

### ä»¥åä½¿ç”¨ï¼ˆåŒä¸€ç»ˆç«¯ä¼šè¯ï¼‰ï¼š
```bash
# æ— éœ€è¾“å…¥å¯†ç ï¼Œç›´æ¥ä½¿ç”¨
git push origin main
```

### æ£€æŸ¥å·²åŠ è½½çš„å¯†é’¥ï¼š
```bash
ssh-add -l
```

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### 1. å¯†ç ä¿æŠ¤
- å¯†é’¥å·²è®¾ç½®å¯†ç ï¼ˆé˜²æ­¢ç‰©ç†è®¿é—®ï¼‰
- å¯†ç åªéœ€è¾“å…¥ä¸€æ¬¡
- macOS Keychain å®‰å…¨ä¿å­˜

### 2. ssh-agent ç®¡ç†
- è‡ªåŠ¨åŠ è½½å¯†é’¥
- å†…å­˜ä¸­å®‰å…¨å­˜å‚¨
- ä¼šè¯é—´ä¿æŒè¿æ¥

### 3. æœ€å°æƒé™
- IdentitiesOnly yes - åªä½¿ç”¨æŒ‡å®šå¯†é’¥
- ç‹¬ç«‹ SSH å¯†é’¥ï¼ˆä¸æ··ç”¨å…¶ä»–å¯†é’¥ï¼‰

### 4. è¿æ¥ä¼˜åŒ–
- ServerAliveInterval - é˜²æ­¢è¿æ¥æ–­å¼€
- Compression - å‡å°‘ç½‘ç»œä¼ è¾“
- HashKnownHosts - ä¿æŠ¤å·²çŸ¥ä¸»æœºåˆ—è¡¨

## ğŸ”„ å¯†é’¥ç®¡ç†

### æ·»åŠ æ–° SSH å¯†é’¥ï¼š
```bash
ssh-keygen -t ed25519 -f ~/.ssh/another_key -C "email@example.com"
# ç¼–è¾‘ ~/.ssh/config æ·»åŠ æ–°å¯†é’¥
```

### åˆ é™¤å¯†é’¥ï¼ˆå¦‚æœæ³„éœ²ï¼‰ï¼š
1. è®¿é—® https://github.com/settings/keys
2. åˆ é™¤å¯¹åº”çš„ SSH key
3. æœ¬åœ°åˆ é™¤å¯†é’¥æ–‡ä»¶
4. ç”Ÿæˆæ–°å¯†é’¥æ›¿æ¢

### è½®æ¢å¯†é’¥ï¼ˆæ¯6ä¸ªæœˆï¼‰ï¼š
```bash
# ç”Ÿæˆæ–°å¯†é’¥
ssh-keygen -t ed25519 -f ~/.ssh/github_key_new

# æ·»åŠ åˆ° GitHub
cat ~/.ssh/github_key_new.pub  # å¤åˆ¶å¹¶æ·»åŠ åˆ° GitHub

# æµ‹è¯•æ–°å¯†é’¥
ssh -T git@github.com

# ç¡®è®¤æ–°å¯†é’¥å·¥ä½œåï¼Œåˆ é™¤æ—§å¯†é’¥
```

## ğŸ“ é‡è¦æé†’

1. **æ°¸è¿œä¸è¦åˆ†äº«ä½ çš„ç§é’¥**
   - ~/.ssh/github_key
   - ä¸è¦é€šè¿‡é‚®ä»¶ã€èŠå¤©ç­‰æ–¹å¼å‘é€

2. **å®šæœŸå¤‡ä»½å…¬é’¥**
   - ~/.ssh/github_key.pub
   - GitHub é¡µé¢å¯ä»¥æŸ¥çœ‹

3. **ç›‘æ§æœªæˆæƒè®¿é—®**
   - æŸ¥çœ‹ GitHub çš„ "Recent Activity"
   - æ£€æŸ¥ "Security" æ ‡ç­¾é¡µçš„è­¦å‘Š

## ğŸš€ ä¸‹ä¸€æ­¥ï¼ˆå¯é€‰ï¼‰

### ä½¿ç”¨ GitHub CLIï¼ˆæ›´ç°ä»£çš„æ–¹å¼ï¼‰ï¼š
```bash
# å®‰è£…
brew install gh

# ç™»å½•
gh auth login --with-token

# ä½¿ç”¨ï¼ˆæ— éœ€ SSH å¯†é’¥ï¼‰
gh repo view
```

### é…ç½®å¤šä¸ª GitHub è´¦æˆ·ï¼š
```bash
# ä¸ºå·¥ä½œè´¦æˆ·ç”Ÿæˆå•ç‹¬å¯†é’¥
ssh-keygen -t ed25519 -f ~/.ssh/work_github_key

# åœ¨ ~/.ssh/config ä¸­æ·»åŠ 
Host github-work.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/work_github_key
    IdentitiesOnly yes

# å…‹éš†æ—¶ä½¿ç”¨è‡ªå®šä¹‰åŸŸå
git clone git@github-work.com:org/repo.git
```

## âœ… é…ç½®å®Œæˆ

ä½ çš„ SSH è®¤è¯å·²ç»æŒ‰ç…§èµ„æ·±å¼€å‘è€…çš„æ ‡å‡†é…ç½®å®Œæˆï¼
